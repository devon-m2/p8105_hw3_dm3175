---
title: "p8105_hw3_dm3175"
author: "Devon Morgan"
date: "10/9/2018"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(ggridges)
library(patchwork)
library(p8105.datasets)
library("dplyr")
library(viridis)
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

```

# Problem 1

The BRFSS dataset includes data from the Behavioral Risk Factors Surveillance System from 2002-2010. This dataset is located in the `p8105.datasets` package. The same dataset was used in homework 2.  

## Import and Clean Dataset
Loaded and cleaned BRFSS data from `p9105.datasets` package: 

```{r load BRFSS Data}
brfss_data = p8105.datasets::brfss_smart2010 %>% 
    janitor::clean_names() %>%
    filter(topic == "Overall Health") %>% 
    mutate(response = factor(response, levels = c("Excellent", "Very good", "Good", "Fair", "Poor")))
  
```

The following steps were taken to clean the dataset: 

*  Cleaned variable names using `janitor::clean_names`.

*  Verified variable types imported correctly.

*  Filtered data to only consider "Overall Health" topic.

*  Using the `factor` function, organized the responses as a factor ordered with 5 levels: `Excellent`, `Very good`, `Good`, `Fair`, and `Poor`. 

## Questions

*  **In 2002, which states were observed at 7 locations?**

```{r}
brfss_data %>% 
  filter(year == 2002) %>% 
  group_by(locationabbr) %>% 
  summarize(count_locations = n_distinct(locationdesc)) %>% 
  filter(count_locations == 7) %>% 
  knitr::kable(digits = 1)
```




Make a “spaghetti plot” that shows the number of locations in each state from 2002 to 2010.
Make a table showing, for the years 2002, 2006, and 2010, the mean and standard deviation of the proportion of “Excellent” responses across locations in NY State.
For each year and state, compute the average proportion in each response category (taking the average across locations in a state). Make a five-panel plot that shows, for each response category separately, the distribution of these state-level averages over time.
